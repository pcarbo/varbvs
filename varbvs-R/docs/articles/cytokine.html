<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assessing support for gene sets in disease using varbvs • varbvs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">varbvs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/pcarbo/varbvs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Assessing support for gene sets in disease using varbvs</h1>
            
            <h4 class="date">2017-04-04</h4>
          </div>

    
    
<div class="contents">
<p>In this vignette, we fit two variable selection models: the first (“null”) model has a uniform prior for all variables (the 442,001 genetic markers); the second model has higher prior probability for genetic markers near cytokine signaling genes. This analysis is intended to assess support for enrichment of Crohn’s disease risk factors near cytokine signaling genes; a large Bayes factor means greater support for this enrichment hypothesis. The data in this analysis consist of 442,001 SNPs genotyped for 1,748 cases and 2,938 controls. Note that file <code>cd.RData</code> cannot be made publicly available due to data sharing restrictions, so this script is for viewing only.</p>
<p>Begin by loading a couple packages into the R environment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
<span class="kw">library</span>(varbvs)</code></pre></div>
<p>Set the random number generator seed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)</code></pre></div>
<div id="load-the-genotypes-phenotypes-and-pathway-annotation" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-genotypes-phenotypes-and-pathway-annotation" class="anchor"></a>Load the genotypes, phenotypes and pathway annotation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">"cd.RData"</span>)
<span class="kw">data</span>(cytokine)</code></pre></div>
</div>
<div id="fit-variational-approximation-to-posterior" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-variational-approximation-to-posterior" class="anchor"></a>Fit variational approximation to posterior</h2>
<p>Here we compute the variational approximation given the assumption that all variables (genetic markers) are, <em>a priori</em>, equally likely to be included in the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.null &lt;-<span class="st"> </span><span class="kw"><a href="../reference/varbvs.html">varbvs</a></span>(X,<span class="ot">NULL</span>,y,<span class="st">"binomial"</span>,<span class="dt">logodds =</span> -<span class="dv">4</span>)</code></pre></div>
<p>Next, compute the variational approximation given the assumption that genetic markers near cytokine signaling genes are more likely to be included in the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logodds &lt;-<span class="st"> </span><span class="kw">matrix</span>(-<span class="dv">4</span>,<span class="dv">442001</span>,<span class="dv">13</span>)
logodds[cytokine ==<span class="st"> </span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">matrix</span>(-<span class="dv">4</span> +<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.25</span>),<span class="dv">6711</span>,<span class="dv">13</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>)
fit.cytokine &lt;-<span class="st"> </span><span class="kw"><a href="../reference/varbvs.html">varbvs</a></span>(X,<span class="ot">NULL</span>,y,<span class="st">"binomial"</span>,<span class="dt">logodds =</span> logodds,
                       <span class="dt">alpha =</span> fit.null$alpha,<span class="dt">mu =</span> fit.null$mu,
                       <span class="dt">eta =</span> fit.null$eta,<span class="dt">optimize.eta =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Compute the Bayes factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BF &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bayesfactor.html">bayesfactor</a></span>(fit.null$logw,fit.cytokine$logw)</code></pre></div>
</div>
<div id="save-the-results-to-a-file" class="section level2">
<h2 class="hasAnchor">
<a href="#save-the-results-to-a-file" class="anchor"></a>Save the results to a file</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">c</span>(<span class="st">"fit.null"</span>,<span class="st">"fit.cytokine"</span>,<span class="st">"map"</span>,<span class="st">"cytokine"</span>,<span class="st">"BF"</span>),
     <span class="dt">file =</span> <span class="st">"varbvs.demo.cytokine.RData"</span>)</code></pre></div>
</div>
<div id="summarize-the-results-of-model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#summarize-the-results-of-model-fitting" class="anchor"></a>Summarize the results of model fitting</h2>
<p>Show two “genome-wide scans” from the multi-marker PIPs, with and without conditioning on enrichment of cytokine signaling genes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normalizelogweights.html">normalizelogweights</a></span>(fit.cytokine$logw)
i &lt;-<span class="st"> </span><span class="kw">which</span>(fit.null$alpha &gt;<span class="st"> </span><span class="fl">0.5</span> |<span class="st"> </span>fit.cytokine$alpha %*%<span class="st"> </span>w &gt;<span class="st"> </span><span class="fl">0.5</span>)
var.labels &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(map$pos[i]/<span class="fl">1e6</span>,<span class="dt">digits =</span> <span class="dv">2</span>),<span class="st">"Mb"</span>)
<span class="kw">print</span>(<span class="kw">plot</span>(fit.null,<span class="dt">groups =</span> map$chr,<span class="dt">vars =</span> i,<span class="dt">var.labels =</span> <span class="ot">NULL</span>,
           <span class="dt">gap =</span> <span class="dv">7500</span>,<span class="dt">ylab =</span> <span class="st">"posterior prob."</span>),
      <span class="dt">split =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">more =</span> <span class="ot">TRUE</span>)
<span class="kw">print</span>(<span class="kw">plot</span>(fit.cytokine,<span class="dt">groups =</span> map$chr,<span class="dt">vars =</span> i,<span class="dt">var.labels =</span> var.labels,
           <span class="dt">gap =</span> <span class="dv">7500</span>,<span class="dt">ylab =</span> <span class="st">"posterior prob."</span>),
      <span class="dt">split =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">more =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-the-genotypes-phenotypes-and-pathway-annotation">Load the genotypes, phenotypes and pathway annotation</a></li>
      <li><a href="#fit-variational-approximation-to-posterior">Fit variational approximation to posterior</a></li>
      <li><a href="#save-the-results-to-a-file">Save the results to a file</a></li>
      <li><a href="#summarize-the-results-of-model-fitting">Summarize the results of model fitting</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Peter Carbonetto, Matthew Stephens, David Gerard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
