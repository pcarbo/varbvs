<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Large-Scale Bayesian Variable Selection Using Variational Methods • varbvs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">varbvs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/pcarbo/varbvs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="large-scale-bayesian-variable-selection-for-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#large-scale-bayesian-variable-selection-for-r" class="anchor"></a>Large-scale Bayesian variable selection for R</h1></div>

<div id="overview" class="section level3">
<h3 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h3>
<p>We introduce <em>varbvs</em>, an R package for analysis of large-scale data sets using Bayesian variable selection methods. To facilitate application of Bayesian variable selection to a range of problems, the <em>varbvs</em> interface hides most of the complexities of modeling and optimization, while also providing many options for adaptation to range of applications. The <em>varbvs</em> software has been used to implement Bayesian variable selection for large problems with over a million variables and thousands of samples, including analysis of massive genome-wide data sets.</p>
<p>The R package been tested by <a href="https://travis-ci.org/pcarbo/varbvs.svg?branch=master">Travis CI</a>, and the tests’ code coverage has been assessed by <a href="https://codecov.io/gh/pcarbo/varbvs">Codecov</a>.</p>
</div>
<div id="citing-varbvs" class="section level3">
<h3 class="hasAnchor">
<a href="#citing-varbvs" class="anchor"></a>Citing varbvs</h3>
<p>If you find that this software is useful for your research project, please cite our paper:</p>
<p>Carbonetto, P., and Stephens, M. (2012). Scalable variational inference for Bayesian variable selection in regression, and its accuracy in genetic association studies. <em>Bayesian Analysis</em> <strong>7</strong>, 73-108.</p>
</div>
<div id="license" class="section level3">
<h3 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h3>
<p>Copyright (c) 2012-2016, Peter Carbonetto.</p>
<p>The <em>varbvs</em> source code repository by <a href="http://github.com/pcarbo">Peter Carbonetto</a> is free software: you can redistribute it under the terms of the <a href="http://www.gnu.org/licenses/gpl.html">GNU General Public License</a>. All the files in this project are part of <em>varbvs</em>. This project is distributed in the hope that it will be useful, but <strong>without any warranty</strong>; without even the implied warranty of <strong>merchantability or fitness for a particular purpose</strong>. See file <a href="../LICENSE">LICENSE</a> for the full text of the license.</p>
</div>
<div id="installing-the-package" class="section level3">
<h3 class="hasAnchor">
<a href="#installing-the-package" class="anchor"></a>Installing the package</h3>
<p>To install the official release of the <em>varbvs</em> package available from CRAN (<a href="http://www.r-pkg.org/pkg/varbvs">link</a>), in R simply run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"varbvs"</span>)</code></pre></div>
<p>Alternatively, you can to install the most up-to-date development version. The easiest way to accomplish this is using the <a href="http://www.r-pkg.org/pkg/devtools">devtools</a> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
<span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">"pcarbo/varbvs"</span>,<span class="dt">subdir =</span> <span class="st">"varbvs-R"</span>)</code></pre></div>
<p>Without devtools, it is a little more complicated, but not hard. Begin by downloading the github repository for this project. The simplest way to do this is to <a href="http://github.com/pcarbo/varbvs/archive/master.zip">download the repository as a ZIP archive</a>. Once you have extracted the files from the compressed archive, you will see that the main directory has two subdirectories, one containing the MATLAB code, and the other containing the files for the R package.</p>
<p>This subdirectory has all the necessary files to build and install a package for R. To install this package, follow the <a href="https://cran.r-project.org/doc/manuals/R-admin.html">standard instructions</a> for installing an R package from source. On a Unix or Unix-like platform (e.g., Mac OS X), the following steps should install the R package:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="fu">mv</span> varbvs-R varbvs
<span class="ex">R</span> CMD build varbvs
<span class="ex">R</span> CMD INSTALL varbvs_2.0.0.tar.gz</code></pre></div>
</div>
<div id="using-the-package" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-package" class="anchor"></a>Using the package</h3>
<p>Once you have installed the package, load the package in R by entering</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(varbvs)</code></pre></div>
<p>To get an overview of the package, enter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(<span class="dt">package =</span> <span class="st">"varbvs"</span>)</code></pre></div>
<p>The key function in this package is function <code>varbvs</code>. Here is an example in which we fit the variable selection model to the Leukemia data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(varbvs)
<span class="kw">data</span>(leukemia)
fit &lt;-<span class="st"> </span><span class="kw"><a href="reference/varbvs.html">varbvs</a></span>(leukemia$x,<span class="ot">NULL</span>,leukemia$y,<span class="dt">family =</span> <span class="st">"binomial"</span>,
              <span class="dt">logodds =</span> <span class="kw">seq</span>(-<span class="fl">3.5</span>,-<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="dt">sa =</span> <span class="dv">1</span>)
<span class="kw">print</span>(<span class="kw">summary</span>(fit))</code></pre></div>
<p>To get more information about this function, type</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(varbvs)</code></pre></div>
</div>
<div id="working-examples" class="section level3">
<h3 class="hasAnchor">
<a href="#working-examples" class="anchor"></a>Working examples</h3>
<p>We have provided several R scripts in the <a href="vignettes" class="uri">vignettes</a> and <a href="tests" class="uri">tests</a> folders to illustrate application of <em>varbvs</em> to small and large data sets:</p>
<ul>
<li><p>Script <a href="tests/testthat/demo.qtl.R">demo.qtl.R</a> demonstrates how to use the varbvs function for mapping a quantitative trait (<em>i.e.</em>, a continuously valued outcome) in a small, simulated data set. Script <a href="tests/testthat/demo.cc.R">demo.cc.R</a> demonstrates mapping of a binary valued outcome in a simulated data set.</p></li>
<li><p>Script <a href="vignettes/demo.leukemia.R">demo.leukemia.R</a> demonstrates application of both <em>glmnet</em> and <em>varbvs</em> to the Leukemia data. The main aim of this script is to illustrate some of the different properties of <em>varbvs</em> (Bayesian variable selection) and <em>glmnet</em> (penalized sparse regression). This script also reproduces the results and graphs presented in the first example of Carbonetto <em>et al</em> (2016).</p></li>
<li><p>Like demo.qtl.R, script <a href="vignettes/demo.cfw.R">demo.cfw.R</a> also demonstrates <em>varbvs</em> for mapping genetic factors contributing to a quantitative trait, but here it is applied to an actual data set generated from an outbred mouse study. Running this script with <code>trait = “testis”</code> reproduces the results and figures given in the second example of Carbonetto <em>et al</em> (2016).</p></li>
<li><p>Finally, scripts <a href="vignettes/demo.cd.R">demo.cd.R</a> and <a href="vignettes/demo.cytokine.R">demo.cytokine.R</a> show how the <em>varbvs</em> package can be applied to a very large data set to map genetic loci and test biological hypotheses about genetic factors contributing to human disease risk. Although we cannot share the data needed to run these scripts due to data privacy restrictions, we have included these scripts because it is helpful to be able to follow the steps given in these R scripts. These scripts reproduce some of the results and figures presented in Carbonetto <em>et al</em> (2016).</p></li>
</ul>
</div>
<div id="how-to-build-static-html-documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-build-static-html-documentation" class="anchor"></a>How to build static HTML documentation</h2>
<p>These are the R commands to build the website (make sure you are connected to Internet while running these commands, and the working directory is set to <code>varbvs-R</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pkgdown)
<span class="kw">build_site</span>(<span class="dt">mathjax =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="credits" class="section level3">
<h3 class="hasAnchor">
<a href="#credits" class="anchor"></a>Credits</h3>
<p>The <em>varbvs</em> software package was developed by:<br><a href="http://pcarbo.github.io">Peter Carbonetto</a><br> Dept. of Human Genetics, University of Chicago<br> and AncestryDNA, San Francisco, California<br> 2012-2016</p>
<p>Xiang Zhou, Xiang Zhu and Matthew Stephens have also contributed to the development of this software.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=varbvs">https://​cran.r-project.org/​package=varbvs</a>
</li>
<li>Browse source code at <br><a href="http://github.com/pcarbo/varbvs">http://​github.com/​pcarbo/​varbvs</a>
</li>
<li>Report a bug at <br><a href="http://github.com/pcarbo/varbvs/issues">http://​github.com/​pcarbo/​varbvs/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>GPL (&gt;= 3)</p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Peter Carbonetto <br><small class="roles"> Author, maintainer </small> </li>
<li>Matthew Stephens <br><small class="roles"> Author </small> </li>
<li>David Gerard <br><small class="roles"> Author </small> </li>
</ul>
<div>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=varbvs"><img src="http://www.r-pkg.org/badges/version/varbvs" alt="CRAN status badge"></a></li>
<li><a href="https://travis-ci.org/pcarbo/varbvs"><img src="https://travis-ci.org/pcarbo/varbvs.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/pcarbo/varbvs"><img src="https://codecov.io/gh/pcarbo/varbvs/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Peter Carbonetto, Matthew Stephens, David Gerard.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
